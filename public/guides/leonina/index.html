<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Guest Help â€” Via Leonina 71</title>
<link rel="icon" type="image/jpeg" href="logo-niceflatinrome.jpg">
<style>
*{box-sizing:border-box}
body{margin:0;font-family:system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,sans-serif;background:#f6f6f6}
.wrap{max-width:760px;margin:0 auto;min-height:100vh;display:flex;flex-direction:column}
header{position:sticky;top:0;background:#fff;border-bottom:1px solid #e0e0e0;padding:10px 14px}
.h-row{display:flex;align-items:center;gap:12px;flex-wrap:wrap}
.h-left{display:flex;align-items:center;gap:10px}
.brand{font-weight:700;color:#a33}
.apt{margin-left:auto;opacity:.75}
img.logo{height:36px;width:auto;display:block}
.controls{display:flex;gap:8px;margin-top:8px}
#voiceBtn{padding:8px 10px;border:1px solid #ddd;background:#fff;border-radius:10px;cursor:pointer;font-size:14px}
#voiceBtn[aria-pressed="true"]{background:#2b2118;color:#fff;border-color:#2b2118}
main{flex:1;padding:12px}
.msg{max-width:85%;line-height:1.35;border-radius:12px;padding:10px 12px;margin:8px 0;white-space:pre-wrap}
.msg.wd{background:#fff;border:1px solid #e0e0e0}
.msg.me{background:#e8f0fe;border:1px solid #c5d5ff;margin-left:auto}
.quick{display:flex;gap:8px;flex-wrap:wrap;margin:10px 0}
.quick button{border:1px solid #d6c5b8;background:#fff;color:#333;padding:6px 10px;border-radius:12px;cursor:pointer}
.quick button:active{transform:translateY(1px)}
footer{position:sticky;bottom:0;background:#fff;display:flex;gap:8px;padding:10px;border-top:1px solid #e0e0e0}
input{flex:1;padding:12px;border:1px solid #cbd5e1;border-radius:10px;outline:none}
#sendBtn{padding:12px 14px;border:1px solid #2b2118;background:#2b2118;color:#fff;border-radius:10px;cursor:pointer}
.intro{background:#fff;border:1px solid #e0e0e0;padding:12px;border-radius:12px;margin:12px 0}
.intro b{display:block;margin-bottom:6px}
</style>
</head>
<body>
<div class="wrap">
  <header>
    <div class="h-row">
      <div class="h-left">
        <img class="logo" src="logo-niceflatinrome.jpg" alt="NiceFlatInRome">
        <div class="brand">niceflatinrome.com</div>
      </div>
      <div class="apt">Apartment: LEONINA71</div>
    </div>
    <div class="controls">
      <button id="voiceBtn" aria-pressed="false" title="Toggle voice">ðŸ”‡ Voice: Off</button>
    </div>
  </header>

  <main id="chat" aria-live="polite"></main>

  <footer>
    <input id="input" placeholder="Type a messageâ€¦ e.g., wifi, terrace, transport" autocomplete="off">
    <button id="sendBtn">Send</button>
  </footer>
</div>

<script>
/* ------- DATA (Via Leonina 71) ------- */
const apt = {
  checkin_time:'15:00',
  checkout_time:'11:00',

  // Wi-Fi
  wifi_note:'Router on the table. Turn it around to see the SSID and password on the label.',
  wifi_ssid:'See router label',
  wifi_password:'See router label',

  // Inside / water / AC / bathroom / towels / lighting
  water_note:'Tap water is safe to drink. Hot water is always available. IMPORTANT: do NOT touch the switch on the left side of the bathroom mirror (it controls the hot water system).',
  ac_note:'Air conditioning is available. Please turn it OFF when you leave the apartment.',
  bathroom_amenities:'Hairdryer, bath mat, toilet paper, hand soap.',
  towels_note:'Per guest: 1 large + 1 medium + 1 small towel. Beds are prepared on arrival.',
  lighting_note:'Kitchen lights: switch on the right side of the stairs (facing the kitchen). Terrace lights: switch inside on the right before exiting to the terrace.',

  // Kitchen / Safety (electric plate)
  kitchen_note:'Kitchen is fully equipped. There is an electric hot plate: ALWAYS switch it off after use and never leave pots/pans unattended.',

  // Terrace / plants
  terrace_note:'If you open the terrace umbrella, TIE it to the railing. Always close and untie it before leaving the apartment.',
  plants_note:'If you like, you may water the plants once a day (except cacti).',

  // Building & access
  front_door_access:'Use the long key with the square end; pull the heavy door toward you and turn the key counter-clockwise to open.',
  building_code:'Main door code (alternative to round key): 7171 + key symbol.',
  intercom_note:'â€”',

  // Assistance
  host_phone:'+39 335 5245756',

  // Nearby services
  supermarkets:'Carrefour Express (Via Urbana) â€¢ Mini-markets on Via Leonina.',
  pharmacies:'Farmacia Cavour (Via Cavour 84) â€¢ Pharmacy on Via Panisperna 40.',
  atms:'BNL ATM (Via Cavour 84) â€¢ UniCredit ATM (Piazza della Suburra 5).',
  laundry:'Wash & Dry Laundromat â€” Via Cavour 194 (self-service).',
  luggage:'Radical Storage points around Termini and Largo Argentina (book online).',
  sims:'Iliad â€” Via Cavour 196 â€¢ TIM/Vodafone â€” Via Nazionale.',

  // Transport
  transport:'Metro B â€” Cavour station (â‰ˆ5 min walk). Bus lines 75, 117, 84 on Via Cavour. Walking is ideal around Monti.',
  airports:'Fiumicino: Metro B Cavour â†’ Termini â†’ Leonardo Express (32 min) or FL1 from Trastevere. Ciampino: bus to Termini â†’ Metro B Cavour. Private transfer: Welcome Pickups.',
  taxi:'Radio Taxi +39 06 3570 (or FreeNow app).',

  // Safety & numbers
  emergency:'EU Emergency 112 â€¢ Police 113 â€¢ Ambulance 118 â€¢ Fire 115 â€¢ English-speaking doctor +39 06 488 2371 â€¢ 24h vet +39 06 660 681',

  // Eat / Drink / Shop / Visit / Hidden gems / Walks / Day trips
  eat:'La Carbonara â€¢ Ai Tre Scalini â€¢ Trattoria Vecchia Roma â€¢ Fafiuche Wine Bar â€¢ Al42 by Pasta Chef Monti â€¢ Broccoletti â€¢ Cuoco e Camicia',
  drink:'VinoRoma Wine Studio â€¢ La Bottega del CaffÃ¨ (Piazza Madonna dei Monti) â€¢ Spritzeria Monti â€¢ Blackmarket Hall.',
  shop:'Mercato Monti Vintage Market (Via Leonina 46, weekends) â€¢ Via Urbana & Via del Boschetto boutiques â€¢ Panisperna Libreria â€¢ Artisan leather & design stores in Monti.',
  visit:'Piazza Madonna dei Monti â€¢ Santa Maria ai Monti â€¢ San Martino ai Monti â€¢ San Pietro in Vincoli (Michelangeloâ€™s Moses) â€¢ Colle Oppio Park & Domus Aurea â€¢ Trajanâ€™s Market & Forum.',
  hidden_gems:'Sotterranei di San Martino ai Monti (guided tours) â€¢ Basilica di Santa Prassede (Chapel of St. Zeno) â€¢ Scalinata dei Borgia â€¢ Ancient Suburra streets (Via Cavour/Leonina/Panisperna) â€¢ Roman houses beneath Santa Pudenziana.',
  experiences:'Aperitivo in Piazza Madonna dei Monti â€¢ Vintage browsing at Mercato Monti (weekends) â€¢ Rooftop/terrace photos at sunset â€¢ Stroll Via Urbana & Via dei Serpenti â€¢ Evening walk past the Roman Forum and Piazza Venezia.',
  romantic_walk:'Start Via Leonina 71 â†’ Colosseum â†’ Arch of Constantine â†’ Via dei Fori Imperiali â†’ Piazza del Campidoglio (view) â†’ Fatamorgana Monti gelato â†’ La Bottega del CaffÃ¨ â†’ back to Via Leonina 71.',
  daytrips:'Ostia Antica (~40 min) â€¢ Tivoli (Villa dâ€™Este & Hadrianâ€™s Villa ~1h) â€¢ Castelli Romani (villages & wine).',

  checkout_note:'Before leaving: turn off lights/AC, close windows, leave keys on the table, gently close the door.'
};

const faqs = [
  { k:'wifi', keys:['wifi','wi-fi','internet','password','router'],
    t:`Wi-Fi: ${apt.wifi_note}\nNetwork: ${apt.wifi_ssid}. Password: ${apt.wifi_password}.` },

  { k:'check in', keys:['check in','arrival','access','entrance','door','front door','building','code','intercom'],
    t:`Check-in from ${apt.checkin_time}.\nAccess: ${apt.front_door_access}\nBuilding code: ${apt.building_code}\nNeed help? Call ${apt.host_phone}.` },

  { k:'check out', keys:['check out','leave','departure'], t: apt.checkout_note },

  { k:'water', keys:['water','hot water','drinkable','tap','mirror switch','boiler'], t: apt.water_note },

  { k:'AC', keys:['ac','air conditioning','aircon','air conditioner'], t: apt.ac_note },

  { k:'bathroom', keys:['bathroom','hairdryer','soap','towels','amenities'], t:`Bathroom: ${apt.bathroom_amenities}\nTowels: ${apt.towels_note}` },

  { k:'kitchen', keys:['kitchen','cook','cooking','stove','hot plate'], t: apt.kitchen_note },

  { k:'terrace', keys:['terrace','umbrella','plants','balcony','light'], t:`Terrace: ${apt.terrace_note}\nPlants: ${apt.plants_note}\nLights: ${apt.lighting_note}` },

  { k:'services', keys:['pharmacy','hospital','atm','sim','laundry','luggage','supermarket','groceries'],
    t:`Supermarkets: ${apt.supermarkets}
Pharmacies: ${apt.pharmacies}
ATMs: ${apt.atms}
Laundry: ${apt.laundry}
Luggage storage: ${apt.luggage}
SIMs: ${apt.sims}` },

  { k:'transport', keys:['transport','tram','bus','taxi','airport','train','metro'],
    t:`${apt.transport}\nAirports: ${apt.airports}\nTaxi: ${apt.taxi}` },

  { k:'eat', keys:['eat','restaurant','dinner','lunch','food'], t: apt.eat },
  { k:'drink', keys:['drink','bar','wine','cocktail','aperitivo'], t: apt.drink },
  { k:'shop', keys:['shop','market','shopping','boutique','vintage'], t: apt.shop },
  { k:'visit', keys:['what to visit','see','sight','attraction','museum','moses','domus aurea'], t: apt.visit },
  { k:'hidden gems', keys:['hidden','secret','gem','less-known','underground','suburra','pudenziana'], t: apt.hidden_gems },
  { k:'experience', keys:['experience','walk','tour','itinerary','sunset','romantic'], t:`${apt.experiences}\nRomantic route: ${apt.romantic_walk}` },
  { k:'day trips', keys:['day trip','tivoli','ostia','castelli','excursion'], t: apt.daytrips },
  { k:'emergency', keys:['emergency','police','ambulance','fire','doctor','vet','help'], t: apt.emergency }
];

/* ------- UI (no server calls) ------- */
const chatEl = document.getElementById('chat');
const input  = document.getElementById('input');
const sendBtn= document.getElementById('sendBtn');

// Voice (Samantha â€“ EN only)
let voiceOn=false, pick=null;
function pickSamantha(){
  const all = window.speechSynthesis ? (speechSynthesis.getVoices()||[]) : [];
  const en  = all.filter(v=>/en-/i.test(v.lang));
  pick = en.find(v=>/samantha/i.test(v.name)) || en[0] || all[0] || null;
}
if('speechSynthesis' in window){
  pickSamantha(); window.speechSynthesis.onvoiceschanged = pickSamantha;
}
function warm(){ try{ const u=new SpeechSynthesisUtterance('Voice enabled.'); if(pick) u.voice=pick; u.lang='en-US'; speechSynthesis.cancel(); speechSynthesis.speak(u);}catch{} }
function speak(t){ if(!voiceOn||!('speechSynthesis' in window)) return; try{ const u=new SpeechSynthesisUtterance(t); if(pick) u.voice=pick; u.lang='en-US'; speechSynthesis.cancel(); speechSynthesis.speak(u);}catch{} }
document.getElementById('voiceBtn').addEventListener('click',e=>{
  voiceOn=!voiceOn; e.currentTarget.setAttribute('aria-pressed',String(voiceOn));
  e.currentTarget.textContent = voiceOn ? 'ðŸ”Š Voice: On' : 'ðŸ”‡ Voice: Off';
  if(voiceOn) warm();
});

function add(type, txt){
  const d=document.createElement('div');
  d.className='msg '+(type==='me'?'me':'wd');
  d.textContent=txt;
  chatEl.appendChild(d);
  chatEl.scrollTop=chatEl.scrollHeight;
}

function welcome(){
  const intro=document.createElement('div');
  intro.className='intro';
  intro.innerHTML='<b>Hi, Iâ€™m Samantha, your virtual guide.</b>Tap a button to get a quick answer.';
  chatEl.appendChild(intro);

  const q=document.createElement('div'); q.className='quick';
  const items=['wifi','check in','check out','water','AC','bathroom','kitchen','terrace','eat','drink','shop','visit','hidden gems','experience','day trips','transport','services','emergency'];
  for(const it of items){
    const b=document.createElement('button'); b.textContent=it;
    b.onclick=()=>{ input.value=it; send(); };
    q.appendChild(b);
  }
  chatEl.appendChild(q);
}

function detectIntent(msg){
  const t=(msg||'').toLowerCase();
  let best=null,score=0;
  for(const f of faqs){
    let s=0; for(const k of f.keys){ if(t.includes(k.toLowerCase())) s++; }
    if(s>score){ score=s; best=f; }
  }
  return score>0?best:null;
}
function send(){
  const text=(input.value||'').trim(); if(!text) return;
  add('me',text); input.value='';
  const m=detectIntent(text);
  const bot = m ? m.t : 'I did not find a direct answer. Try a quick button (wifi, terrace, transportâ€¦).';
  add('wd',bot); speak(bot);
}

sendBtn.addEventListener('click',send);
input.addEventListener('keydown',e=>{ if(e.key==='Enter') send(); });
welcome();
</script>
</body>
</html>
