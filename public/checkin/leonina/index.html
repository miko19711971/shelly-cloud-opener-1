Leonina

<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title id="title">Check-in Guide ‚Äî Via Leonina 71</title>
<link rel="icon" href="building-door.jpg">
<style>
  :root { --brand:#2b2118; --ink:#1f2937; --muted:#6b7280; --bg:#f7f7f7; --card:#ffffff; --line:#e5e7eb; }
  *{box-sizing:border-box}
  body{margin:0;font-family:system-ui,-apple-system,Segoe UI,Roboto,sans-serif;background:var(--bg);color:var(--ink)}
  .wrap{max-width:860px;margin:0 auto;padding:16px}
  header{position:sticky;top:0;background:var(--card);border-bottom:1px solid var(--line);padding:12px 14px;z-index:5}
  h1{font-size:20px;margin:0}
  .addr{font-size:14px;color:var(--muted)}
  .lang{font-size:14px;margin-top:6px}
  .lang a{color:var(--ink);text-decoration:none;font-weight:700;margin-right:10px}
  .lang a.active{text-decoration:underline}
  .card{background:var(--card);border:1px solid var(--line);border-radius:12px;padding:14px;margin:14px 0}
  .step{display:flex;gap:12px;align-items:flex-start}
  .num{flex:0 0 36px;height:36px;border-radius:50%;background:var(--brand);color:#fff;display:flex;align-items:center;justify-content:center;font-weight:700}
  h2{margin:6px 0 8px 0;font-size:18px}
  p{margin:6px 0;line-height:1.45}
  figure{margin:10px 0}
  img{max-width:100%;height:auto;border-radius:10px;border:1px solid var(--line);display:block}
  figure img{width:90%;margin:0 auto}
  figcaption{font-size:12px;color:var(--muted);margin-top:6px;text-align:center}
  .note{background:#fff7ed;border:1px solid #fed7aa;color:#7c2d12;padding:10px;border-radius:8px;margin-top:8px}
  .cta{display:inline-block;margin-top:10px;padding:10px 12px;border-radius:10px;background:var(--brand);color:#fff;text-decoration:none;cursor:pointer}
  .status{font-size:13px;color:#6b7280;margin-top:6px}
  footer{color:var(--muted);text-align:center;font-size:12px;margin:18px 0}
  .imgframe{width:90%;margin:0 auto;border:1px solid var(--line);border-radius:10px;display:block}
  .imgframe object{width:100%;height:auto;display:block;border-radius:10px;aspect-ratio:3/4;background:#f9fafb}
  .hide{display:none!important}
</style>
</head>
<body>
<header class="wrap">
  <h1 id="h1">Check-in Guide ‚Äî Via Leonina 71</h1>
  <div class="addr" id="addr">Address: Via Leonina 71, Rome ‚Ä¢ Entrance keypad: 16 or 7171 + üîë</div>
  <div class="lang" id="langbar">Language:
    <!-- verr√† riempita via JS con EN ¬∑ IT ¬∑ FR ¬∑ DE ¬∑ ES -->
  </div>
</header>

<main class="wrap">
  <!-- 1 -->
  <section class="card">
    <div class="step">
      <div class="num">1</div>
      <div>
        <h2 id="s1_t">Open the Building Door</h2>
        <p id="s1_p">Press the button below to open the building door.</p>

        <!-- ‚úÖ PATCH: non usare /token (admin). Usa /checkin/... con token t -->
        <a class="cta" href="#" onclick="openWith('statusBuilding','building');return false;" id="btn_building">‚ûú Open Building Door</a>
        <div class="status" id="statusBuilding"></div>

        <!-- foto locale -->
        <figure>
          <img src="building-door.jpg"
               alt="Building entrance ‚Äî Via Leonina 71"
               style="width:90%;margin:0 auto;display:block;border-radius:10px;border:1px solid #e5e7eb">
          <figcaption id="s1_cap">Fa√ßade and entrance ‚Äî Via Leonina 71.</figcaption>
        </figure>
      </div>
    </div>
  </section>

  <!-- 2 -->
  <section class="card">
    <div class="step">
      <div class="num">2</div>
      <div>
        <h2 id="s2_t">Walk to the end of the corridor</h2>
        <p id="s2_p" class="hide"></p>
        <figure>
          <img src="elevator-corridor.jpg" alt="Corridor leading to the elevator">
          <figcaption id="s2_cap">End of corridor ‚Äî the last door on the right is the elevator.</figcaption>
        </figure>
      </div>
    </div>
  </section>

  <!-- 3 -->
  <section class="card">
    <div class="step">
      <div class="num">3</div>
      <div>
        <h2 id="s3_t">Take the elevator to the 4th floor</h2>
        <p id="s3_p" class="hide"></p>
      </div>
    </div>
  </section>

  <!-- 4 -->
  <section class="card">
    <div class="step">
      <div class="num">4</div>
      <div>
        <h2 id="s4_t">This is your apartment door</h2>
        <p id="s4_p">Press the button only once when you are sure it‚Äôs the correct door.</p>

        <!-- ‚úÖ PATCH: non usare /token (admin). Usa /checkin/... con token t -->
        <a class="cta" href="#" onclick="openWith('statusApartment','apartment');return false;" id="btn_apartment">‚ûú Open Apartment Door</a>
        <div class="status" id="statusApartment"></div>

        <figure>
          <img src="apartment-door.jpg" alt="Apartment door ‚Äî Via Leonina 71">
          <figcaption id="s4_cap">Apartment entrance ‚Äî green door on the top floor.</figcaption>
        </figure>
      </div>
    </div>
  </section>

  <section class="card">
    <h2 id="help_h">Need help?</h2>
    <p id="help_p">Call or WhatsApp: <a class="cta" href="tel:+393355245756">+39 335 524 5756</a></p>
  </section>

  <footer id="footer">niceflatinrome.com ‚Ä¢ Quick visual guide for arrivals at Via Leonina 71</footer>
</main>

<script>
async function openWith(statusId, which){
  const s=document.getElementById(statusId);
  try{
    const params = new URLSearchParams(window.location.search);
    const t = params.get("t") || "";

    if(!t){
      s.textContent = "Link non valido (token mancante).";
      return;
    }

    s.textContent='Opening‚Ä¶';

    // ‚úÖ robusto: per la porta prova "apartment" e se non esiste prova "door"
    const tries = (which === "building") ? ["building"] : ["apartment","door"];

    for (const kind of tries) {
      const r = await fetch(`/checkin/leonina/open/${kind}?t=${encodeURIComponent(t)}`, {
        method: "POST",
        cache: "no-store"
      });

      // se endpoint non esiste, prova il prossimo
      if (r.status === 404) continue;

      const j = await r.json().catch(()=> ({}));

      if(r.ok && j.ok){
        s.textContent = "Done.";
      } else {
        s.textContent = (j.error || j.message) ? String(j.error || j.message) : `Error (${r.status})`;
      }
      return; // ‚úÖ finito (ok o errore ‚Äúvero‚Äù)
    }

    s.textContent = "Error (endpoint not found).";
  }catch(e){
    s.textContent='Network error. Try again.';
  }
}
  /* -------- 5 lingue (bottoni inclusi) -------- */
const T = {
  en: {
    title:'Check-in Guide ‚Äî Via Leonina 71',
    addr:'Address: Via Leonina 71, Rome ‚Ä¢ Entrance keypad: 16 or 7171 + üîë',
    s1_t:'Open the Building Door',
    s1_p:'Press the button below to open the building door.',
    s1_cap:'Fa√ßade and entrance ‚Äî Via Leonina 71.',
    s2_t:'Walk to the end of the corridor',
    s2_p:'Go straight until the end of the corridor.',
    s2_cap:'End of corridor ‚Äî the last door on the right is the elevator.',
    s3_t:'Take the elevator to the 4th floor',
    s3_p:'Get the elevator and arrive at the fourth floor.',
    s4_t:'This is your apartment door',
    s4_p:'Press the button only once when you are sure it‚Äôs the correct door.',
    s4_cap:'Apartment entrance ‚Äî green door on the top floor.',
    help_h:'Need help?',
    help_p:'Call or WhatsApp: <a class="cta" href="tel:+393355245756">+39 335 524 5756</a>',
    btn_building:'‚ûú Open Building Door',
    btn_apartment:'‚ûú Open Apartment Door',
    footer:'niceflatinrome.com ‚Ä¢ Quick visual guide for arrivals at Via Leonina 71',
    langLabel:'Language', langName:'English'
  },

  it: {
    title:'Guida Check-in ‚Äî Via Leonina 71',
    addr:'Indirizzo: Via Leonina 71, Roma ‚Ä¢ Tastierino ingresso: 16 oppure 7171 + üîë',
    s1_t:'Apri il portone del palazzo',
    s1_p:'Premi il pulsante qui sotto per aprire il portone.',
    s1_cap:'Facciata e ingresso ‚Äî Via Leonina 71.',
    s2_t:'Vai in fondo al corridoio',
    s2_p:'Prosegui dritto fino alla fine del corridoio.',
    s2_cap:'Fondo corridoio ‚Äî l‚Äôultima porta a destra √® l‚Äôascensore.',
    s3_t:'Prendi l‚Äôascensore al 4¬∞ piano',
    s3_p:'Prendi l‚Äôascensore e sali al quarto piano.',
    s4_t:'Questa √® la porta del tuo appartamento',
    s4_p:'Premi il pulsante una sola volta quando sei sicuro che sia la porta corretta.',
    s4_cap:"Ingresso dell'appartamento ‚Äî porta verde all‚Äôultimo piano.",
    help_h:'Serve aiuto?',
    help_p:'Chiama o WhatsApp: <a class="cta" href="tel:+393355245756">+39 335 524 5756</a>',
    btn_building:'‚ûú Apri il portone',
    btn_apartment:'‚ûú Apri porta appartamento',
    footer:'niceflatinrome.com ‚Ä¢ Guida rapida per gli arrivi a Via Leonina 71',
    langLabel:'Lingua', langName:'Italiano'
  },
  fr: {
    title:'Guide d‚Äôenregistrement ‚Äî Via Leonina 71',
    addr:'Adresse : Via Leonina 71, Rome ‚Ä¢ Clavier d‚Äôentr√©e : 16 ou 7171 + üîë',
    s1_t:'Ouvrir la porte de l‚Äôimmeuble',
    s1_p:'Appuyez sur le bouton ci-dessous pour ouvrir la porte.',
    s1_cap:'Fa√ßade et entr√©e ‚Äî Via Leonina 71.',
    s2_t:'Allez au bout du couloir',
    s2_p:'Allez tout droit jusqu‚Äôau bout du couloir.',
    s2_cap:'Fin du couloir ‚Äî la derni√®re porte √† droite est l‚Äôascenseur.',
    s3_t:'Prenez l‚Äôascenseur jusqu‚Äôau 4e √©tage',
    s3_p:'Prenez l‚Äôascenseur et montez au quatri√®me √©tage.',
    s4_t:'Voici la porte de votre appartement',
    s4_p:'Appuyez une seule fois lorsque vous √™tes s√ªr que c‚Äôest la bonne porte.',
    s4_cap:"Entr√©e de l‚Äôappartement ‚Äî porte verte au dernier √©tage.",
    help_h:'Besoin d‚Äôaide ?',
    help_p:'Appeler ou WhatsApp : <a class="cta" href="tel:+393355245756">+39 335 524 5756</a>',
    btn_building:'‚ûú Ouvrir la porte de l‚Äôimmeuble',
    btn_apartment:"‚ûú Ouvrir la porte de l‚Äôappartement",
    footer:'niceflatinrome.com ‚Ä¢ Guide visuel rapide pour les arriv√©es √† Via Leonina 71',
    langLabel:'Langue', langName:'Fran√ßais'
  },

  de: {
    title:'Check-in-Leitfaden ‚Äî Via Leonina 71',
    addr:'Adresse: Via Leonina 71, Rom ‚Ä¢ Eingangstastatur: 16 oder 7171 + üîë',
    s1_t:'Haust√ºr √∂ffnen',
    s1_p:'Dr√ºcken Sie unten auf die Taste, um die Haust√ºr zu √∂ffnen.',
    s1_cap:'Fassade und Eingang ‚Äî Via Leonina 71.',
    s2_t:'Bis zum Ende des Flurs gehen',
    s2_p:'Gehen Sie geradeaus bis zum Ende des Flurs.',
    s2_cap:'Flurende ‚Äî die letzte T√ºr rechts ist der Aufzug.',
    s3_t:'Mit dem Aufzug in den 4. Stock',
    s3_p:'Nehmen Sie den Aufzug in den vierten Stock.',
    s4_t:'Das ist Ihre Wohnungst√ºr',
    s4_p:'Dr√ºcken Sie die Taste nur einmal, wenn Sie sicher sind, dass es die richtige T√ºr ist.',
    s4_cap:'Wohnungseingang ‚Äî gr√ºne T√ºr im obersten Stock.',
    help_h:'Brauchen Sie Hilfe?',
    help_p:'Anrufen oder WhatsApp: <a class="cta" href="tel:+393355245756">+39 335 524 5756</a>',
    btn_building:'‚ûú Haust√ºr √∂ffnen',
    btn_apartment:'‚ûú Wohnungst√ºr √∂ffnen',
    footer:'niceflatinrome.com ‚Ä¢ Kurzanleitung f√ºr die Anreise in die Via Leonina 71',
    langLabel:'Sprache', langName:'Deutsch'
  },
  es: {
    title:'Gu√≠a de check-in ‚Äî Via Leonina 71',
    addr:'Direcci√≥n: Via Leonina 71, Roma ‚Ä¢ Teclado de entrada: 16 o 7171 + üîë',
    s1_t:'Abrir la puerta del edificio',
    s1_p:'Pulsa el bot√≥n de abajo para abrir la puerta del edificio.',
    s1_cap:'Fachada y entrada ‚Äî Via Leonina 71.',
    s2_t:'Ve hasta el final del pasillo',
    s2_p:'Sigue recto hasta el final del pasillo.',
    s2_cap:'Final del pasillo ‚Äî la √∫ltima puerta a la derecha es el ascensor.',
    s3_t:'Toma el ascensor hasta el 4¬∫ piso',
    s3_p:'Toma el ascensor y sube al cuarto piso.',
    s4_t:'Esta es la puerta de tu apartamento',
    s4_p:'Pulsa el bot√≥n solo una vez cuando est√©s seguro de que es la puerta correcta.',
    s4_cap:'Entrada del apartamento ‚Äî puerta verde en el √∫ltimo piso.',
    help_h:'¬øNecesitas ayuda?',
    help_p:'Llama o WhatsApp: <a class="cta" href="tel:+393355245756">+39 335 524 5756</a>',
    btn_building:'‚ûú Abrir puerta del edificio',
    btn_apartment:'‚ûú Abrir puerta del apartamento',
    footer:'niceflatinrome.com ‚Ä¢ Gu√≠a visual r√°pida para llegadas a Via Leonina 71',
    langLabel:'Idioma', langName:'Espa√±ol'
  }
};

/* applica lingua + barra link */
(function(){
  const params=new URLSearchParams(location.search);
  const L=(params.get('lang')||'en').toLowerCase();
  const t=T[L]||T.en;

  const token = params.get('t') || '';
  const base  = 'index.html';  // ‚úÖ sempre sul file giusto

  // barra lingue con token preservato
  document.getElementById('langbar').innerHTML =
    `${t.langLabel}: ` +
    Object.entries(T).map(([k,v])=>{
      const cls=(k===L)?'active':'';
      const p = new URLSearchParams();
      p.set('lang', k);
      if(token) p.set('t', token);
      return `<a class="${cls}" href="${base}?${p.toString()}">${v.langName}</a>`;
    }).join(' ¬∑ ');

  // applica testi
  const set = (id, val) => { const el=document.getElementById(id); if(el) el.textContent = val; };
  document.getElementById('title').textContent=t.title;
  set('h1', t.title);
  set('addr', t.addr);
  set('s1_t', t.s1_t); set('s1_p', t.s1_p); set('s1_cap', t.s1_cap);
  set('s2_t', t.s2_t); set('s2_p', t.s2_p); set('s2_cap', t.s2_cap);
  set('s3_t', t.s3_t); set('s3_p', t.s3_p);
  set('s4_t', t.s4_t); set('s4_p', t.s4_p); set('s4_cap', t.s4_cap);
  set('help_h', t.help_h);
  const helpP = document.getElementById('help_p'); if(helpP) helpP.innerHTML = t.help_p;
  set('footer', t.footer);
  set('btn_building', t.btn_building);
  set('btn_apartment', t.btn_apartment);

  // evidenzia lingua attiva
  document.querySelectorAll('#langbar a').forEach(a=>{
    a.classList.toggle('active', a.textContent===t.langName);
  });
})();
</script>
</body>
</html>

  
  
