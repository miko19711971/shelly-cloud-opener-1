<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title id="title">Check-in Guide — Via Arenula 16</title>
<link rel="icon" href="building-door.jpg">
<style>
  :root { --brand:#2b2118; --ink:#1f2937; --muted:#6b7280; --bg:#f7f7f7; --card:#ffffff; --line:#e5e7eb; }
  *{box-sizing:border-box}
  body{margin:0;font-family:system-ui,-apple-system,Segoe UI,Roboto,sans-serif;background:var(--bg);color:var(--ink)}
  .wrap{max-width:860px;margin:0 auto;padding:16px}
  header{position:sticky;top:0;background:var(--card);border-bottom:1px solid var(--line);padding:12px 14px;z-index:5}
  h1{font-size:20px;margin:0}
  .addr{font-size:14px;color:var(--muted)}
  .lang{font-size:14px;margin-top:6px}
  .lang a{color:var(--ink);text-decoration:none}
  .lang a.active{text-decoration:underline}
  .card{background:var(--card);border:1px solid var(--line);border-radius:12px;padding:14px;margin:14px 0}
  .step{display:flex;gap:12px;align-items:flex-start}
  .num{flex:0 0 36px;height:36px;border-radius:50%;background:var(--brand);color:#fff;display:flex;align-items:center;justify-content:center;font-weight:700}
  h2{margin:6px 0 8px 0;font-size:18px}
  p{margin:6px 0;line-height:1.45}
  figure{margin:10px 0}
  img{max-width:100%;height:auto;border-radius:10px;border:1px solid var(--line);display:block}
  figure img{width:90%;margin:0 auto}
  figcaption{font-size:12px;color:var(--muted);margin-top:6px;text-align:center}
  .note{background:#fff7ed;border:1px solid #fed7aa;color:#7c2d12;padding:10px;border-radius:8px;margin-top:8px}
  .cta{display:inline-block;margin-top:10px;padding:10px 12px;border-radius:10px;background:var(--brand);color:#fff;text-decoration:none;cursor:pointer}
  .status{font-size:13px;color:#6b7280;margin-top:6px}
  footer{color:var(--muted);text-align:center;font-size:12px;margin:18px 0}
</style>
</head>
<body>
<header class="wrap">
  <h1 id="h1">Check-in Guide — Via Arenula 16</h1>
  <div class="addr" id="addr">Address: Via Arenula 16, Rome • Intercom: C8 • Elevator: private, do not use</div>
  <div class="lang" id="langbar">Language:
    <a href="?lang=en" data-lang="en" class="active">English</a> ·
    <a href="?lang=it" data-lang="it">Italiano</a> ·
    <a href="?lang=es" data-lang="es">Español</a> ·
    <a href="?lang=fr" data-lang="fr">Français</a> ·
    <a href="?lang=de" data-lang="de">Deutsch</a>
  </div>
</header>

<main class="wrap">
  <!-- 1 (esempio generico, invariato) -->
  <section class="card">
    <div class="step">
      <div class="num">1</div>
      <div>
        <h2 id="s1_t">Outside the Building</h2>
        <p id="s1_p">Arrive at Via Arenula 16.</p>
        <figure>
          <img src="arenula-front.jpg" alt="Building façade — Via Arenula 16">
          <figcaption id="s1_cap">Façade and main gate — Via Arenula 16.</figcaption>
        </figure>
      </div>
    </div>
  </section>

  <!-- 2 Using the Intercom -->
  <section class="card">
    <div class="step">
      <div class="num">2</div>
      <div>
        <h2 id="s2_t">Using the Intercom</h2>
        <p id="s2_p">Press C8 on the intercom panel.</p>
        <!-- RIMOSSI: telefono / testo extra -->
        <figure>
          <img src="intercom.jpg" alt="Intercom panel — press C8">
          <figcaption id="s2_cap">Intercom panel — press C8.</figcaption>
        </figure>
      </div>
    </div>
  </section>

  <!-- 3 Entering the Main Door -->
  <section class="card">
    <div class="step">
      <div class="num">3</div>
      <div>
        <h2 id="s3_t">Entering the Main Door</h2>
        <p id="s3_p" style="display:none"></p>
        <!-- Bottoni invariati -->
        <a class="cta" href="#" onclick="openWith('statusBuilding','/token/arenula-building');return false;" id="btn_building">➜ Open Building Door</a>
        <div class="status" id="statusBuilding"></div>
      </div>
    </div>
  </section>

  <!-- 4 Inside the Building -->
  <section class="card">
    <div class="step">
      <div class="num">4</div>
      <div>
        <h2 id="s4_t">Inside the Building</h2>
        <p id="s4_p">Walk straight across the corridor into the courtyard, then take the stairs on your right after the elevator.</p>
        <div class="note" id="s4_note">The elevator is strictly private — We are not allowed to use it.</div>
        <figure>
          <img src="inside-corridor.jpg" alt="Inside corridor and courtyard access">
          <figcaption id="s4_cap">Corridor to the courtyard; stairs are on the right after the elevator.</figcaption>
        </figure>
      </div>
    </div>
  </section>

  <!-- 5 (porta appartamento, invariato) -->
  <section class="card">
    <div class="step">
      <div class="num">5</div>
      <div>
        <h2 id="s5_t">This is your apartment door</h2>
        <p id="s5_p">Press the button only once when you are sure it’s the correct door.</p>
        <a class="cta" href="#" onclick="openWith('statusApartment','/token/arenula-door');return false;" id="btn_apartment">➜ Open Apartment Door</a>
        <div class="status" id="statusApartment"></div>
        <figure>
          <img src="apartment-door.jpg" alt="Apartment door — Via Arenula 16">
          <figcaption id="s5_cap">Apartment entrance.</figcaption>
        </figure>
      </div>
    </div>
  </section>

  <footer id="footer">niceflatinrome.com • Quick visual guide for arrivals at Via Arenula 16</footer>
</main>

<script>
async function openWith(statusId, path){
  const s=document.getElementById(statusId);
  try{
    s.textContent='Generating one-time key…';
    const r=await fetch(path,{cache:'no-store'});
    const j=await r.json();
    if(j && j.url){ s.textContent='Key OK. Opening…'; location.href=j.url; }
    else{ s.textContent=(j && (j.error||j.message)) ? String(j.error||j.message) : 'No URL returned.'; }
  }catch(e){ s.textContent='Network error. Try again.'; }
}

/* Dizionario testi (se usi i18n come nelle altre) — mantieni pure il tuo oggetto T esistente.
   Importante: le chiavi s3_p e i contenuti extra che abbiamo nascosto restano ma non si vedono. */
</script>
</body>
</html>
