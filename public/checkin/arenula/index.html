<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title id="doc_title">Check-in Guide ‚Äî Via Arenula 16</title>
<link rel="icon" href="building-door.jpg">
<style>
  :root { --brand:#2b2118; --ink:#1f2937; --muted:#6b7280; --bg:#f7f7f7; --card:#ffffff; --line:#e5e7eb; }
  *{box-sizing:border-box}
  body{margin:0;font-family:system-ui,-apple-system,Segoe UI,Roboto,sans-serif;background:var(--bg);color:var(--ink)}
  .wrap{max-width:860px;margin:0 auto;padding:16px}
  header{position:sticky;top:0;background:var(--card);border-bottom:1px solid var(--line);padding:12px 14px;z-index:5}
  h1{font-size:20px;margin:0}
  .addr{font-size:14px;color:var(--muted)}
  .lang{font-size:14px;margin-top:6px}
  .lang a{color:var(--ink);text-decoration:none;font-weight:700;margin-right:10px}
  .lang a.active{text-decoration:underline}
  .card{background:var(--card);border:1px solid var(--line);border-radius:12px;padding:14px;margin:14px 0}
  .step{display:flex;gap:12px;align-items:flex-start}
  .num{flex:0 0 36px;height:36px;border-radius:50%;background:var(--brand);color:#fff;display:flex;align-items:center;justify-content:center;font-weight:700}
  h2{margin:6px 0 8px 0;font-size:18px}
  p{margin:6px 0;line-height:1.45}
  figure{margin:10px 0}
  img{max-width:100%;height:auto;border-radius:10px;border:1px solid var(--line);display:block}
  figure img{width:90%;margin:0 auto}
  figcaption{font-size:12px;color:var(--muted);margin-top:6px;text-align:center}
  .note{background:#fff7ed;border:1px solid #fed7aa;color:#7c2d12;padding:10px;border-radius:8px;margin-top:8px}
  .cta{display:inline-block;margin-top:10px;padding:10px 12px;border-radius:10px;background:var(--brand);color:#fff;text-decoration:none;cursor:pointer}
  .status{font-size:13px;color:#6b7280;margin-top:6px}
  footer{color:var(--muted);text-align:center;font-size:12px;margin:18px 0}
</style>
</head>
<body>
<header class="wrap">
  <h1 id="title">Check-in Guide ‚Äî Via Arenula 16</h1>
  <div class="addr" id="addr">Address: Via Arenula 16, Rome ‚Ä¢ Intercom: C8 ‚Ä¢ Elevator: private, do not use</div>
  <div class="lang" id="langbar">Language:</div>
</header>

<main class="wrap">
  <!-- 1 -->
  <section class="card">
    <div class="step">
      <div class="num">1</div>
      <div>
        <h2 id="s1_t">Arriving at the Building</h2>
        <p id="s1_p">When you reach Via Arenula 16, look for the large wooden entrance door with the number 16 engraved on the stone frame.</p>
        <figure>
          <img src="building-facade.jpg" alt="Building fa√ßade ‚Äî Via Arenula 16">
          <figcaption id="s1_cap">Fa√ßade and main entrance ‚Äî Via Arenula 16.</figcaption>
        </figure>
      </div>
    </div>
  </section>

  <!-- 2 -->
  <section class="card">
    <div class="step">
      <div class="num">2</div>
      <div>
        <h2 id="s2_t">Using the Intercom</h2>
        <p id="s2_p">Press C8 on the intercom panel.</p>
        <figure>
          <img src="intercom.jpg" alt="Intercom panel ‚Äî press C8">
          <figcaption id="s2_cap">Intercom panel ‚Äî press C8.</figcaption>
        </figure>
      </div>
    </div>
  </section>

  <!-- 3 -->
  <section class="card">
    <div class="step">
      <div class="num">3</div>
      <div>
        <h2 id="s3_t">Entering the Main Door</h2>
        <p id="s3_p" style="display:none"></p>
        <!-- ‚úÖ Bottone aggiornato: usa /token/arenula-building via openWith -->
  <a class="cta" id="btn_building" href="#"
   onclick="openWith('status','arenula-building');return false;">
  Open Building Door
</a>
        <div class="status" id="status"></div>
      </div>
    </div>
  </section>

  <!-- 4 -->
  <section class="card">
    <div class="step">
      <div class="num">4</div>
      <div>
        <h2 id="s4_t">Inside the Building</h2>
        <p id="s4_p">Walk straight across the corridor into the courtyard, then take the stairs on your right after the elevator.</p>
        <div class="note" id="s4_note">The elevator is strictly private ‚Äî We are not allowed to use it.</div>
        <figure>
          <img src="hallway.jpg" alt="Inside corridor and courtyard access">
          <figcaption id="s4_cap">Corridor to the courtyard; stairs are on the right after the elevator.</figcaption>
        </figure>
      </div>
    </div>
  </section>

  <!-- 5 -->
  <section class="card">
    <div class="step">
      <div class="num">5</div>
      <div>
        <h2 id="s5_t">This is your apartment door</h2>
        <p id="s5_p">Attached to the handle you will find a grey lockbox. The code is 6-7-9-3. Inside you will find the keys: open the cover, take the keys, close the cover again, and scramble the numbers.</p>
        <div class="status" id="statusApartment"></div>
        <figure>
          <img src="apartment-door.jpg" alt="Apartment door ‚Äî Via Arenula 16">
          <figcaption id="s5_cap">Apartment entrance.</figcaption>
        </figure>
      </div>
    </div>
  </section>

  <section class="card">
    <h2 id="help_h">Need help?</h2>
    <p id="help_p">Call or WhatsApp: <a class="cta" href="tel:+393355245756">+39 335 524 5756</a></p>
  </section>

  <footer id="footer">niceflatinrome.com ‚Ä¢ Quick visual guide for arrivals at Via Arenula 16</footer>
</main>

<script>
 async function openWith(statusId, target){
  const s = document.getElementById(statusId);
  try{
    const params = new URLSearchParams(location.search);
    const token = params.get('t');   // üëà token del check-in

    if(!token){
      s.textContent = 'Link non valido (token mancante).';
      return;
    }

    s.textContent='Opening‚Ä¶';

    const params2 = new URLSearchParams(window.location.search);
    const t = params2.get("t");

    const res = await fetch(`/checkin/arenula/open/building?t=${encodeURIComponent(t)}`, {
      method: "POST"
    });
    const j = await res.json();

    if(res.ok && j.ok){
      s.textContent='Done.';
    } else {
      s.textContent = (j.error || j.message) ? String(j.error || j.message) : `Error (${res.status})`;
    }
  } catch(e){
    s.textContent='Network error. Try again.';
  }
}
  /* 5 lingue + bottoni */
const T = {
  en:{title:'Check-in Guide ‚Äî Via Arenula 16',addr:'Address: Via Arenula 16, Rome ‚Ä¢ Intercom: C8 ‚Ä¢ Elevator: private, do not use',
      s1_t:'Arriving at the Building',s1_p:'When you reach Via Arenula 16, look for the large wooden entrance door with the number 16 engraved on the stone frame.',s1_cap:'Fa√ßade and main entrance ‚Äî Via Arenula 16.',
      s2_t:'Using the Intercom',s2_p:'Press C8 on the intercom panel.',s2_cap:'Intercom panel ‚Äî press C8.',
      s3_t:'Entering the Main Door',s3_p:'Push the door once it is unlocked.',
      s4_t:'Inside the Building',s4_p:'Walk straight across the corridor into the courtyard, then take the stairs on your right after the elevator.',s4_note:'The elevator is strictly private ‚Äî We are not allowed to use it.',s4_cap:'Corridor to the courtyard; stairs are on the right after the elevator.',
      s5_t:'This is your apartment door',
      s5_p:'Attached to the handle you will find a grey lockbox. The code is 6-7-9-3. Inside you will find the keys: open the cover, take the keys, close the cover again, and scramble the numbers.',
      s5_cap:'Apartment entrance.',
      help_h:'Need help?',help_p:'Call or WhatsApp: <a class="cta" href="tel:+393355245756">+39 335 524 5756</a>',
      btn_building:'Open Building Door',btn_apartment:'Open Apartment Door',
      footer:'niceflatinrome.com ‚Ä¢ Quick visual guide for arrivals at Via Arenula 16',langLabel:'Language',langName:'English'},
  it:{title:'Guida Check-in ‚Äî Via Arenula 16',addr:'Indirizzo: Via Arenula 16, Roma ‚Ä¢ Citofono: C8 ‚Ä¢ Ascensore: privato, non usare',
      s1_t:"Arrivo all'edificio",s1_p:'Cerca il grande portone in legno con il numero 16 inciso sulla cornice in pietra.',s1_cap:'Facciata e ingresso principale ‚Äî Via Arenula 16.',
      s2_t:'Uso del citofono',s2_p:'Premi C8 sul pannello del citofono.',s2_cap:'Pannello citofono ‚Äî premi C8.',
      s3_t:'Entrata dal portone',s3_p:'Spingi la porta quando √® sbloccata.',
      s4_t:"Dentro l'edificio",s4_p:"Prosegui dritto nel cortile e prendi le scale a destra dopo l'ascensore.",s4_note:"L'ascensore √® strettamente privato ‚Äî non possiamo usarlo.",s4_cap:'Corridoio verso il cortile; scale a destra dopo l‚Äôascensore.',
      s5_t:"Questa √® la porta del tuo appartamento",
      s5_p:"Attaccato alla maniglia troverai un lucchetto grigio. Il codice √® 6-7-9-3. All'interno troverai le chiavi: apri lo sportellino, prendi le chiavi, richiudi lo sportellino e mischia i numeri.",
      s5_cap:"Ingresso dell'appartamento.",
      help_h:'Serve aiuto?',help_p:'Chiama o WhatsApp: <a class="cta" href="tel:+393355245756">+39 335 524 5756</a>',
      btn_building:'Apri portone',btn_apartment:'Apri porta appartamento',
      footer:'niceflatinrome.com ‚Ä¢ Guida rapida per gli arrivi a Via Arenula 16',langLabel:'Lingua',langName:'Italiano'},

  fr:{title:'Guide d‚Äôenregistrement ‚Äî Via Arenula 16',addr:'Adresse : Via Arenula 16, Rome ‚Ä¢ Interphone : C8 ‚Ä¢ Ascenseur : priv√©, ne pas utiliser',
      s1_t:'Arriver √† l‚Äôimmeuble',s1_p:'√Ä votre arriv√©e Via Arenula 16, rep√©rez le grand portail en bois avec le num√©ro 16 grav√© sur la pierre.',s1_cap:'Fa√ßade et entr√©e principale ‚Äî Via Arenula 16.',
      s2_t:'Utiliser l‚Äôinterphone',s2_p:'Appuyez sur C8 sur le panneau de l‚Äôinterphone.',s2_cap:'Panneau d‚Äôinterphone ‚Äî appuyez sur C8.',
      s3_t:'Entrer par le portail',s3_p:'Poussez la porte une fois d√©verrouill√©e.',
      s4_t:'√Ä l‚Äôint√©rieur du b√¢timent',s4_p:'Traversez le couloir jusqu‚Äô√† la cour, puis prenez les escaliers √† droite apr√®s l‚Äôascenseur.',s4_note:'L‚Äôascenseur est strictement priv√© ‚Äî nous ne sommes pas autoris√©s √† l‚Äôutiliser.',s4_cap:'Couloir vers la cour ; escaliers √† droite apr√®s l‚Äôascenseur.',
      s5_t:'Voici la porte de votre appartement',
      s5_p:'Attach√©e √† la poign√©e, vous trouverez une bo√Æte √† cl√©s grise. Le code est 6-7-9-3. √Ä l‚Äôint√©rieur se trouvent les cl√©s : ouvrez le couvercle, prenez les cl√©s, refermez le couvercle et m√©langez les chiffres.',
      s5_cap:"Entr√©e de l‚Äôappartement.",
      help_h:'Besoin d‚Äôaide ?',help_p:'Appeler ou WhatsApp : <a class="cta" href="tel:+393355245756">+39 335 524 5756</a>',
      btn_building:'Ouvrir le portail',btn_apartment:"Ouvrir la porte de l‚Äôappartement",
      footer:'niceflatinrome.com ‚Ä¢ Guide visuel rapide pour l‚Äôarriv√©e √† Via Arenula 16',langLabel:'Langue',langName:'Fran√ßais'},

    de:{title:'Check-in-Leitfaden ‚Äî Via Arenula 16',addr:'Adresse: Via Arenula 16, Rom ‚Ä¢ Gegensprechanlage: C8 ‚Ä¢ Aufzug: privat, nicht benutzen',
      s1_t:'Ankunft am Geb√§ude',s1_p:'Suchen Sie an der Via Arenula 16 das gro√üe Holztor mit der Zahl 16 im Stein.',s1_cap:'Fassade und Haupteingang ‚Äî Via Arenula 16.',
      s2_t:'Gegensprechanlage benutzen',s2_p:'Dr√ºcken Sie C8 an der Gegensprechanlage.',s2_cap:'Gegensprechanlage ‚Äî C8 dr√ºcken.',
      s3_t:'Durch das Haupttor eintreten',s3_p:'Dr√ºcken Sie die T√ºr, sobald sie entriegelt ist.',
      s4_t:'Im Geb√§ude',s4_p:'Gehen Sie durch den Korridor in den Hof und nehmen Sie dann die Treppe rechts nach dem Aufzug.',s4_note:'Der Aufzug ist strikt privat ‚Äî wir d√ºrfen ihn nicht benutzen.',s4_cap:'Korridor zum Hof; Treppe rechts nach dem Aufzug.',
      s5_t:'Dies ist Ihre Wohnungst√ºr',
      s5_p:'An dem Griff befindet sich eine graue Schl√ºsselbox. Der Code lautet 6-7-9-3. Darin finden Sie die Schl√ºssel: √ñffnen Sie die Abdeckung, nehmen Sie die Schl√ºssel heraus, schlie√üen Sie die Abdeckung wieder und mischen Sie die Zahlen.',
      s5_cap:'Wohnungseingang.',
      help_h:'Brauchen Sie Hilfe?',help_p:'Anrufen oder WhatsApp: <a class="cta" href="tel:+393355245756">+39 335 524 5756</a>',
      btn_building:'Haust√ºr √∂ffnen',btn_apartment:'Wohnungst√ºr √∂ffnen',
      footer:'niceflatinrome.com ‚Ä¢ Schnelle visuelle Anreisehilfe f√ºr Via Arenula 16',langLabel:'Sprache',langName:'Deutsch'},
  es:{title:'Gu√≠a de check-in ‚Äî Via Arenula 16',addr:'Direcci√≥n: Via Arenula 16, Roma ‚Ä¢ Portero: C8 ‚Ä¢ Ascensor: privado, no usar',
      s1_t:'Llegada al edificio',s1_p:'Al llegar a Via Arenula 16, busca la gran puerta de madera con el n√∫mero 16 grabado en la piedra.',s1_cap:'Fachada y entrada principal ‚Äî Via Arenula 16.',
      s2_t:'Uso del portero',s2_p:'Pulsa C8 en el panel del portero.',s2_cap:'Panel del portero ‚Äî pulsa C8.',
      s3_t:'Entrar por la puerta principal',s3_p:'Empuja la puerta cuando est√© desbloqueada.',
      s4_t:'Dentro del edificio',s4_p:'Sigue recto por el pasillo hasta el patio y luego toma las escaleras a la derecha, despu√©s del ascensor.',s4_note:'El ascensor es estrictamente privado ‚Äî no est√° permitido usarlo.',s4_cap:'Pasillo hacia el patio; escaleras a la derecha despu√©s del ascensor.',
      s5_t:'Esta es la puerta de tu apartamento',
      s5_p:'Sujetado a la manija encontrar√°s una caja de llaves gris. El c√≥digo es 6-7-9-3. Dentro encontrar√°s las llaves: abre la tapa, toma las llaves, vuelve a cerrar la tapa y mezcla los n√∫meros.',
      s5_cap:'Entrada del apartamento.',
      help_h:'¬øNecesitas ayuda?',help_p:'Llama o WhatsApp: <a class="cta" href="tel:+393355245756">+39 335 524 5756</a>',
      btn_building:'Abrir puerta del edificio',btn_apartment:'Abrir puerta del apartamento',
      footer:'niceflatinrome.com ‚Ä¢ Gu√≠a visual r√°pida para llegar a Via Arenula 16',langLabel:'Idioma',langName:'Espa√±ol'}
};

 /* render lingue */
(function(){
  const params=new URLSearchParams(location.search);
  const code=(params.get('lang')||'en').toLowerCase();
  const t=T[code]||T.en;

  const token = params.get('t') || '';
  const base  = 'index.html';  // ‚úÖ sempre sul file giusto (non /today, non la cartella)

  document.getElementById('langbar').innerHTML =
    `${t.langLabel}: ` +
    Object.entries(T).map(([k,v])=>{
      const cls=(k===code)?'active':'';
      const p = new URLSearchParams();
      p.set('lang', k);
      if(token) p.set('t', token);
      return `<a class="${cls}" href="${base}?${p.toString()}">${v.langName}</a>`;
    }).join(' ¬∑ ');

  const setText=(id,txt)=>{const el=document.getElementById(id); if(el) el.textContent=txt;};
  const setHTML=(id,html)=>{const el=document.getElementById(id); if(el) el.innerHTML=html;};

  setText('title', t.title); setText('doc_title', t.title);
  setText('addr', t.addr);
  setText('s1_t', t.s1_t); setText('s1_p', t.s1_p); setText('s1_cap', t.s1_cap);
  setText('s2_t', t.s2_t); setText('s2_p', t.s2_p); setText('s2_cap', t.s2_cap);
  setText('s3_t', t.s3_t); setText('s3_p', t.s3_p);
  setText('s4_t', t.s4_t); setText('s4_p', t.s4_p); setText('s4_cap', t.s4_cap); setText('s4_note', t.s4_note);
  setText('s5_t', t.s5_t); setText('s5_p', t.s5_p); setText('s5_cap', t.s5_cap);
  setText('help_h', t.help_h); setHTML('help_p', t.help_p);
  setText('btn_building', t.btn_building); setText('btn_apartment', t.btn_apartment);
  setText('footer', t.footer);
})();
</script>
</body>
</html>
