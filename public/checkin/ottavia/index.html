<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title id="title">Check-in Guide — Via del Portico d’Ottavia 1D</title>
<link rel="icon" href="building-door.jpg">
<style>
  :root { --brand:#2b2118; --ink:#1f2937; --muted:#6b7280; --bg:#f7f7f7; --card:#ffffff; --line:#e5e7eb; }
  *{box-sizing:border-box}
  body{margin:0;font-family:system-ui,-apple-system,Segoe UI,Roboto,sans-serif;background:var(--bg);color:var(--ink)}
  .wrap{max-width:860px;margin:0 auto;padding:16px}
  header{position:sticky;top:0;background:var(--card);border-bottom:1px solid var(--line);padding:12px 14px;z-index:5}
  h1{font-size:20px;margin:0}
  .addr{font-size:14px;color:var(--muted)}
  .lang{font-size:14px;margin-top:6px}
  .lang a{color:var(--ink);text-decoration:none}
  .lang a.active{text-decoration:underline}
  .card{background:var(--card);border:1px solid var(--line);border-radius:12px;padding:14px;margin:14px 0}
  .step{display:flex;gap:12px;align-items:flex-start}
  .num{flex:0 0 36px;height:36px;border-radius:50%;background:var(--brand);color:#fff;display:flex;align-items:center;justify-content:center;font-weight:700}
  h2{margin:6px 0 8px 0;font-size:18px}
  p{margin:6px 0;line-height:1.45}
  figure{margin:10px 0}
  img{max-width:100%;height:auto;border-radius:10px;border:1px solid var(--line);display:block}
  figure img{width:90%;margin:0 auto}
  figcaption{font-size:12px;color:var(--muted);margin-top:6px;text-align:center}
  .note{background:#fff7ed;border:1px solid #fed7aa;color:#7c2d12;padding:10px;border-radius:8px;margin-top:8px}
  .cta{display:inline-block;margin-top:10px;padding:10px 12px;border-radius:10px;background:var(--brand);color:#fff;text-decoration:none;cursor:pointer}
  .status{font-size:13px;color:#6b7280;margin-top:6px}
  footer{color:var(--muted);text-align:center;font-size:12px;margin:18px 0}
  .imgframe{width:90%;margin:0 auto;border:1px solid var(--line);border-radius:10px;display:block}
  .imgframe object{width:100%;height:auto;display:block;border-radius:10px;aspect-ratio:3/4;background:#f9fafb}
</style>
</head>
<body>
<header class="wrap">
  <h1 id="h1">Check-in Guide — Via del Portico d’Ottavia 1D</h1>
  <div class="addr" id="addr">Address: Via del Portico d’Ottavia 1D, Rome</div>
  <div class="lang" id="langbar">Language:
    <a href="?lang=en" data-lang="en" class="active">English</a> ·
    <a href="?lang=it" data-lang="it">Italiano</a> ·
    <a href="?lang=fr" data-lang="fr">Français</a> ·
    <a href="?lang=de" data-lang="de">Deutsch</a> ·
    <a href="?lang=es" data-lang="es">Español</a>
  </div>
</header>

<main class="wrap">
  <!-- 1 -->
  <section class="card">
    <div class="step">
      <div class="num">1</div>
      <div>
        <h2 id="s1_t">Open the Building Door</h2>
        <p id="s1_p">Use the button below to unlock the main door.</p>

        <a class="cta" href="#" onclick="openWith('statusBuilding','/token/portico-1d-building');return false;" id="btn_building">➜ Open Building Door</a>
        <div class="status" id="statusBuilding"></div>

        <!-- nascosto per non rompere lo script -->
        <div class="note" id="s1_note" style="display:none"></div>

        <figure>
          <div class="imgframe">
            <object data="https://cdn.jsdelivr.net/gh/miko19711971/shelly-cloud-opener-1@main/public/checkin/ottavia/building-door.jpg"
                    type="image/jpeg" referrerpolicy="no-referrer" crossorigin="anonymous">
              <img src="https://raw.githubusercontent.com/miko19711971/shelly-cloud-opener-1/main/public/checkin/ottavia/building-door.jpg?v=2"
                   alt="Building entrance — Via del Portico d’Ottavia 1D"
                   style="width:100%;height:auto;display:block;border-radius:10px">
            </object>
          </div>
          <figcaption id="s1_cap">Main entrance — Via del Portico d’Ottavia 1D.</figcaption>
        </figure>

        <figure>
          <img src="hallway-light.jpg" alt="Hallway lights turned on">
          <figcaption id="s1_cap2">Press this button to turn on the indoor corridor lights.</figcaption>
        </figure>
      </div>
    </div>
  </section>

  <!-- 2 -->
  <section class="card">
    <div class="step">
      <div class="num">2</div>
      <div>
        <h2 id="s2_t">Arrive at the Third Floor</h2>
        <p id="s2_p">Go up to the 3rd floor.</p>
      </div>
    </div>
  </section>

  <!-- 3 -->
  <section class="card">
    <div class="step">
      <div class="num">3</div>
      <div>
        <h2 id="s3_t">This is Your Apartment Door</h2>
        <p id="s3_p">Please press the button only once when you are certain this is the correct door.</p>

        <a class="cta" href="#" onclick="openWith('statusApartment','/token/portico-1d-door');return false;" id="btn_apartment">➜ Open Apartment Door</a>
        <div class="status" id="statusApartment"></div>

        <figure>
          <img src="apartment-door.jpg" alt="Apartment door — Via del Portico d’Ottavia 1D">
          <figcaption id="s3_cap">Apartment door — 3rd floor.</figcaption>
        </figure>
      </div>
    </div>
  </section>

  <section class="card">
    <h2 id="help_h">Need help?</h2>
    <p id="help_p">Call or WhatsApp: <a class="cta" href="tel:+393355245756">+39 335 524 5756</a></p>
  </section>

  <footer id="footer">niceflatinrome.com • Quick visual guide for arrivals at Via del Portico d’Ottavia 1D</footer>
</main>

<script>
async function openWith(statusId, path){
  const s=document.getElementById(statusId);
  try{
    s.textContent='Generating one-time key…';
    const r=await fetch(path,{cache:'no-store'});
    const j=await r.json();
    if(j && j.url){ s.textContent='Key OK. Opening…'; location.href=j.url; }
    else{ s.textContent=(j && (j.error||j.message)) ? String(j.error||j.message) : 'No URL returned.'; }
  }catch(e){ s.textContent='Network error. Try again.'; }
}

/* ---------- 5 lingue (solo testi) ---------- */
const T = {
  en:{
    title:"Check-in Guide — Via del Portico d’Ottavia 1D",
    addr:"Address: Via del Portico d’Ottavia 1D, Rome",
    s1_t:"Open the Building Door",
    s1_p:"Use the button below to unlock the main door.",
    s1_note:"",
    s1_cap:"Main entrance — Via del Portico d’Ottavia 1D.",
    s1_cap2:"Press this button to turn on the indoor corridor lights.",
    s2_t:"Arrive at the Third Floor",
    s2_p:"Go up to the 3rd floor.",
    s3_t:"This is Your Apartment Door",
    s3_p:"Please press the button only once when you are certain this is the correct door.",
    s3_cap:"Apartment door — 3rd floor.",
    help_h:"Need help?",
    help_p:'Call or WhatsApp: <a class="cta" href="tel:+393355245756">+39 335 524 5756</a>',
    btn_building:"➜ Open Building Door",
    btn_apartment:"➜ Open Apartment Door",
    footer:"niceflatinrome.com • Quick visual guide for arrivals at Via del Portico d’Ottavia 1D"
  },
  it:{
    title:"Guida Check-in — Via del Portico d’Ottavia 1D",
    addr:"Indirizzo: Via del Portico d’Ottavia 1D, Roma",
    s1_t:"Apri il portone dell’edificio",
    s1_p:"Usa il pulsante qui sotto per sbloccare il portone.",
    s1_note:"",
    s1_cap:"Ingresso principale — Via del Portico d’Ottavia 1D.",
    s1_cap2:"Le luci del corridoio si accendono automaticamente quando apri il portone.",
    s2_t:"Arriva al terzo piano",
    s2_p:"Sali al 3° piano.",
    s3_t:"Questa è la porta del tuo appartamento",
    s3_p:"Premi il pulsante una sola volta quando sei certo che sia la porta corretta.",
    s3_cap:"Porta dell’appartamento — 3° piano.",
    help_h:"Serve aiuto?",
    help_p:'Chiama o WhatsApp: <a class="cta" href="tel:+393355245756">+39 335 524 5756</a>',
    btn_building:"➜ Apri il portone",
    btn_apartment:"➜ Apri porta appartamento",
    footer:"niceflatinrome.com • Guida rapida di arrivo a Via del Portico d’Ottavia 1D"
  },
  fr:{
    title:"Guide d’enregistrement — Via del Portico d’Ottavia 1D",
    addr:"Adresse : Via del Portico d’Ottavia 1D, Rome",
    s1_t:"Ouvrir la porte de l’immeuble",
    s1_p:"Appuyez sur le bouton ci-dessous pour déverrouiller la porte principale.",
    s1_note:"",
    s1_cap:"Entrée principale — Via del Portico d’Ottavia 1D.",
    s1_cap2:"Appuyez sur ce bouton pour allumer les lumières du couloir intérieur.",
    s2_t:"Arriver au troisième étage",
    s2_p:"Montez au 3e étage.",
    s3_t:"Voici la porte de votre appartement",
    s3_p:"Appuyez une seule fois lorsque vous êtes sûr que c’est la bonne porte.",
    s3_cap:"Porte de l’appartement — 3e étage.",
    help_h:"Besoin d’aide ?",
    help_p:'Appeler ou WhatsApp : <a class="cta" href="tel:+393355245756">+39 335 524 5756</a>',
    btn_building:"➜ Ouvrir la porte de l’immeuble",
    btn_apartment:"➜ Ouvrir la porte de l’appartement",
    footer:"niceflatinrome.com • Guide visuel rapide pour l’arrivée à Via del Portico d’Ottavia 1D"
  },
  de:{
    title:"Check-in-Leitfaden — Via del Portico d’Ottavia 1D",
    addr:"Adresse: Via del Portico d’Ottavia 1D, Rom",
    s1_t:"Haustür öffnen",
    s1_p:"Drücken Sie unten auf die Taste, um die Haustür zu entriegeln.",
    s1_note:"",
    s1_cap:"Haupteingang — Via del Portico d’Ottavia 1D.",
    s1_cap2:"Drücken Sie diese Taste, um das Licht im Innenkorridor einzuschalten.",
    s2_t:"Am dritten Stock ankommen",
    s2_p:"Gehen Sie in den 3. Stock.",
    s3_t:"Das ist Ihre Wohnungstür",
    s3_p:"Drücken Sie den Knopf nur einmal, wenn Sie sicher sind, dass es die richtige Tür ist.",
    s3_cap:"Wohnungstür — 3. Stock.",
    help_h:"Brauchen Sie Hilfe?",
    help_p:'Anrufen oder WhatsApp: <a class="cta" href="tel:+393355245756">+39 335 524 5756</a>',
    btn_building:"➜ Haustür öffnen",
    btn_apartment:"➜ Wohnungstür öffnen",
    footer:"niceflatinrome.com • Schnelle visuelle Anleitung für die Ankunft a Via del Portico d’Ottavia 1D"
  },
  es:{
    title:"Guía de check-in — Via del Portico d’Ottavia 1D",
    addr:"Dirección: Via del Portico d’Ottavia 1D, Roma",
    s1_t:"Abrir la puerta del edificio",
    s1_p:"Pulsa el botón de abajo para desbloquear la puerta principal.",
    s1_note:"",
    s1_cap:"Entrada principal — Via del Portico d’Ottavia 1D.",
    s1_cap2:"Pulsa este botón para encender las luces del pasillo interior.",
    s2_t:"Llegar al tercer piso",
    s2_p:"Sube al 3.º piso.",
    s3_t:"Esta es la puerta de tu apartamento",
    s3_p:"Pulsa el botón solo una vez cuando estés seguro de que es la puerta correcta.",
    s3_cap:"Puerta del apartamento — 3.º piso.",
    help_h:"¿Necesitas ayuda?",
    help_p:'Llama o WhatsApp: <a class="cta" href="tel:+393355245756">+39 335 524 5756</a>',
    btn_building:"➜ Abrir puerta del edificio",
    btn_apartment:"➜ Abrir puerta del apartamento",
    footer:"niceflatinrome.com • Guía visual rápida para llegadas a Via del Portico d’Ottavia 1D"
  }
};

(function(){
  const params=new URLSearchParams(location.search);
  const L=(params.get('lang')||'en').toLowerCase();
  const t=T[L]||T.en;

  document.querySelectorAll('#langbar a').forEach(a=>{
    a.classList.toggle('active', a.getAttribute('data-lang')===L);
  });

  document.getElementById('title').textContent=t.title;
  document.getElementById('h1').textContent=t.title;
  document.getElementById('addr').textContent=t.addr;

  document.getElementById('s1_t').textContent=t.s1_t;
  document.getElementById('s1_p').textContent=t.s1_p;
  document.getElementById('s1_note').textContent=t.s1_note; // hidden
  document.getElementById('s1_cap').textContent=t.s1_cap;
  document.getElementById('s1_cap2').textContent=t.s1_cap2;

  document.getElementById('s2_t').textContent=t.s2_t;
  document.getElementById('s2_p').textContent=t.s2_p;

  document.getElementById('s3_t').textContent=t.s3_t;
  document.getElementById('s3_p').textContent=t.s3_p;
  document.getElementById('s3_cap').textContent=t.s3_cap;

  document.getElementById('help_h').textContent=t.help_h;
  document.getElementById('help_p').innerHTML=t.help_p;

  document.getElementById('btn_building').textContent=t.btn_building;
  document.getElementById('btn_apartment').textContent=t.btn_apartment;

  document.getElementById('footer').textContent=t.footer;
})();
</script>
</body>
</html>
